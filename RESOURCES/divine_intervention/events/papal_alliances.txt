namespace = di_ally
#on the death of the pope, the successor retains alliance with his previous liege.

#On_death for the pope, sets the scopes.
character_event = {
	id = di_ally.0
	hide_window = yes
	only_rulers = yes
	religion = catholic
	is_triggered_only = yes
	
	trigger = {
		controls_religion = yes
		current_heir = {
			liege = {
				NOT = { character = ROOT }
			}
		}
	}
	
	immediate = {
		current_heir = {
			save_event_target_as = new_pope
			liege = {
				save_event_target_as = liege
			}
			character_event = { id = di_ally.1 days = 1 }
		}
	}
}
#After death for the new pope, actually renews the alliance.
character_event = {
	id = di_ally.1
	hide_window = yes
	only_rulers = yes
	religion = catholic
	is_triggered_only = yes
	
	immediate = {
		event_target:liege = {
			opinion = { modifier = in_non_aggression_pact_di who = ROOT }
			reverse_opinion = { modifier = in_non_aggression_pact_di who = ROOT }
			add_alliance = { who = ROOT years = 1000 }
		}
	}
}